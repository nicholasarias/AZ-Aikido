---
import BaseLayout from "../layouts/Layout.astro";

const newsItems = [
  {
    id: "2025-winter-seminar",
    title: "Winter Seminar – February 15–16, 2025",
    date: "February 15–16, 2025",
    year: 2025,
    category: "Seminar",
    isRecent: true,
    body: [
      "Arizona Aikido will host a weekend seminar at the Agatsu Dojo focusing on fundamentals, ukemi, and weapons integration. All current students and visitors from other dojos are welcome.",
      "Classes will include basics, open-hand technique, and weapons work appropriate to the level of the group. Beginners may participate at a comfortable pace."
    ]
  },
  {
    id: "2025-tony-support",
    title: "Support for Tony – Ongoing donations",
    date: "January 10, 2025",
    year: 2025,
    category: "Dojo Community",
    isRecent: true,
    paypalUrl: "https://www.paypal.com/webapps/shoppingcart?flowlogging_id=f75150565cae7#/checkout/shoppingCart",
    body: [
      "Members and friends of Arizona Aikido have asked for a way to provide financial support for Tony. An online donation link is available for those who wish to help.",
      "Donations are voluntary and separate from regular dojo dues. Thank you for any assistance you choose to offer."
    ]
  },
  {
    id: "2024-schedule-reminder",
    title: "Schedule reminders and holiday changes",
    date: "December 5, 2024",
    year: 2024,
    category: "Schedule",
    isRecent: true,
    body: [
      "Class times may shift around major holidays or when the dojo is hosting seminars. Please check the Schedule page and the latest News posts for any changes before visiting.",
      "If you are a new student planning your first class, you may also email or call ahead to confirm the best day to begin."
    ]
  },
  {
    id: "2018-50th-anniversary",
    title: "50th Anniversary Seminar with Saotome Shihan",
    date: "May 11–13, 2018",
    year: 2018,
    category: "Archive – Seminar",
    isRecent: false,
    body: [
      "In 2018 Arizona Aikido celebrated the 50th anniversary of its founding with a seminar led by Mitsugi Saotome Shihan at the Camelback Road dojo.",
      "Many current and former students, as well as visitors from other dojos, joined in to mark this milestone in the dojo’s history."
    ]
  },
  {
    id: "2016-new-dojo-opening",
    title: "Opening of the Camelback Road dojo",
    date: "December 17, 2016",
    year: 2016,
    category: "Archive – Dojo History",
    isRecent: false,
    body: [
      "Arizona Aikido completed the move to the current dojo at 939 W Camelback Rd in late 2016. Students and friends helped with painting, mat installation, and the first keiko in the new space.",
      "Photos of the move and early classes at the new dojo are available in the Image Gallery."
    ]
  }
];

const recentNews = newsItems.filter((item) => item.isRecent);

const archiveByYear = newsItems.reduce((acc, item) => {
  const y = item.year;
  if (!acc[y]) acc[y] = [];
  acc[y].push(item);
  return acc;
}, {});

const sortedYears = Object.keys(archiveByYear)
  .map((y) => Number(y))
  .sort((a, b) => b - a);
---

<BaseLayout title="Arizona Aikido – News and Notes">
  <!-- Header -->
  <section class="border-b border-slate-800 bg-slate-950/90">
    <div class="mx-auto max-w-6xl px-4 py-10 md:py-14">
      <p class="text-xs font-semibold uppercase tracking-[0.25em] text-sky-400">
        News &amp; notes
      </p>
      <h1 class="mt-2 text-3xl md:text-4xl font-semibold tracking-tight text-slate-50">
        Dojo News and Announcements
      </h1>
      <p class="mt-4 text-sm md:text-base text-slate-300 max-w-3xl">
        This page highlights current announcements, seminar information, and notes about schedule changes
        at Arizona Aikido. Older posts are kept in the archive below so you can look back through the
        dojo’s history.
      </p>
    </div>
  </section>

  <!-- Main content -->
  <section
    class="mx-auto max-w-6xl px-4 py-10 md:py-14 space-y-10 text-sm md:text-base text-slate-200"
  >
    <div class="grid gap-8 lg:grid-cols-[minmax(0,1.5fr)_minmax(0,1fr)]">
      <!-- Recent news -->
      <section class="space-y-5">
        <header class="space-y-2">
          <h2 class="text-lg md:text-xl font-semibold text-slate-50">
            Recent news
          </h2>
          <p class="text-xs md:text-sm text-slate-400">
            These items are the most relevant for planning training, seminars, and visits in the near future.
          </p>
        </header>

        {recentNews.length === 0 ? (
          <p class="text-xs md:text-sm text-slate-400">
            There are no recent announcements at the moment. Please check back soon or contact the dojo
            for the latest information.
          </p>
        ) : (
          <div class="space-y-5">
            {recentNews.map((item) => (
              <article
                id={item.id}
                class="rounded-2xl border border-slate-800 bg-slate-900/80 p-5 md:p-6 space-y-3"
              >
                <div class="flex flex-wrap items-center justify-between gap-2">
                  <p class="text-[0.65rem] md:text-xs font-semibold uppercase tracking-[0.22em] text-sky-300">
                    {item.category}
                  </p>
                  <p class="text-[0.65rem] md:text-xs text-slate-400">
                    {item.date}
                  </p>
                </div>

                <h3 class="text-base md:text-lg font-semibold text-slate-50">
                  {item.title}
                </h3>

                <div class="space-y-2 text-xs md:text-sm text-slate-200">
                  {item.body.map((paragraph) => (
                    <p>{paragraph}</p>
                  ))}
                </div>

                {item.paypalUrl && (
                  <div class="pt-2">
                    <a
                      href={item.paypalUrl}
                      target="_blank"
                      rel="noreferrer"
                      class="inline-flex items-center rounded-full border border-amber-400/70 bg-amber-500/90 px-4 py-2 text-xs md:text-sm font-semibold text-slate-950 shadow-sm hover:bg-amber-400"
                    >
                      Donate via PayPal
                    </a>
                  </div>
                )}
              </article>
            ))}
          </div>
        )}
      </section>

      <!-- Archive sidebar -->
      <aside class="space-y-4">
        <header class="space-y-1">
          <h2 class="text-sm md:text-base font-semibold text-slate-50">
            Archive by year
          </h2>
          <p class="text-xs text-slate-400">
            Open a year below to view older announcements and historical posts.
          </p>
        </header>

        <div class="space-y-3">
          {sortedYears.map((year) => (
            <details class="group rounded-2xl border border-slate-800 bg-slate-900/70">
              <summary
                class="flex cursor-pointer items-center justify-between gap-3 px-4 py-3 md:px-5 md:py-4"
              >
                <div>
                  <h3 class="text-sm md:text-base font-semibold text-slate-50">
                    {year} archive
                  </h3>
                  <p class="mt-1 text-[11px] md:text-xs text-slate-400">
                    {archiveByYear[year].length} post{archiveByYear[year].length > 1 ? "s" : ""} from {year}.
                  </p>
                </div>
                <span class="text-xs text-slate-400 transition-transform group-open:rotate-90">
                  ▶
                </span>
              </summary>

              <div class="border-t border-slate-800 px-4 py-3 md:px-5 md:py-4 space-y-3">
                {archiveByYear[year].map((item) => (
                  <article
                    id={item.id + "-archive"}
                    class="rounded-xl border border-slate-800 bg-slate-950/80 p-3 md:p-4 space-y-1.5"
                  >
                    <div class="flex flex-wrap items-center justify-between gap-2">
                      <p class="text-[0.6rem] md:text-[0.65rem] font-semibold uppercase tracking-[0.2em] text-slate-400">
                        {item.category}
                      </p>
                      <p class="text-[0.6rem] md:text-[0.65rem] text-slate-500">
                        {item.date}
                      </p>
                    </div>
                    <h4 class="text-xs md:text-sm font-semibold text-slate-50">
                      {item.title}
                    </h4>
                    <div class="space-y-1 text-[11px] md:text-xs text-slate-300">
                      {item.body.map((paragraph) => (
                        <p>{paragraph}</p>
                      ))}
                    </div>
                    <a
                      href={"#" + item.id}
                      class="mt-1 inline-flex text-[0.6rem] md:text-[0.65rem] font-semibold text-violet-300 hover:text-violet-200 underline underline-offset-4"
                    >
                      Jump to recent view
                    </a>
                  </article>
                ))}
              </div>
            </details>
          ))}
        </div>
      </aside>
    </div>
  </section>
</BaseLayout>
